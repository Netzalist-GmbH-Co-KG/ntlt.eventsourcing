@namespace MartenAkkaTests.UI.Components.UI
@using MartenAkkaTests.UI.Services
@inject SessionService SessionService
@implements IDisposable

@if (SessionService.HasSession)
{
    <div class="session-status">
        <div class="status-indicator status-active"></div>
        <div class="status-text">
            <div class="status-label">Session Active</div>
            <div class="status-id">@SessionService.BearerToken?[..8]...</div>
        </div>
    </div>
}
else
{
    <div class="session-status">
        <div class="status-indicator status-inactive"></div>
        <div class="status-text">
            <div class="status-label">No Session</div>
        </div>
    </div>
}

@code {
    protected override void OnInitialized()
    {
        SessionService.OnSessionChanged += HandleSessionChanged;
    }

    private void HandleSessionChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        SessionService.OnSessionChanged -= HandleSessionChanged;
    }
}
